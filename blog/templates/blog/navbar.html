{% load static %}
<nav class="bg-white shadow-md p-4 fixed top-0 left-0 w-full z-50">
  <div class="container mx-auto flex items-center justify-between">
   <div>
    <a href="/">
      <img src="{% static './images/logo.png' %}" style="object-fit:cover;" alt="logo" class="h-16 cursor-pointer" />
    </a>
   </div>

   <div class="search-container w-full ml-4 mr-4 max-w-lg mx-auto relative">
    <i class='bx bx-search text-gray-600 p-2 md:hidden text-2xl mt-1 font-bold float-right' id="searchIcon"></i>
    <input 
      type="text" 
      id="searchInput" 
      placeholder="Search posts..." 
      onkeyup="searchPosts()" 
      class="search-input w-full hidden md:block p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 mt-1 focus:border-transparent outline-none"
    >
    <div id="searchResults" class="search-results mt-2 bg-white border border-gray-300 rounded-lg shadow-md max-h-60 overflow-y-auto hidden absolute z-10 w-full">
      <!-- Results will show here -->
    </div>
  </div>
  

    <ul class="flex space-x-6 text-gray-700 font-medium hidden md:flex" id="desktop-menus">
      <li class="relative group">
        <a href="/" class="hover:text-red-600 transition duration-300">
          <i class='bx bxs-home text-xl'></i>
        </a>
        <span class="absolute bottom-8 left-1/2 transform -translate-x-1/2 bg-black text-white text-xs rounded px-2 py-1 opacity-0 group-hover:opacity-100 transition-opacity duration-300">Home</span>
      </li>
    
      {% if user.is_authenticated %}
      <li class="relative group">
        <a href="{% url 'profile' %}" class="hover:text-red-600 transition duration-300">
          <i class='bx bxs-user-circle text-xl'></i>
        </a>
        <span class="absolute bottom-8 left-1/2 transform -translate-x-1/2 bg-black text-white text-xs rounded px-2 py-1 opacity-0 group-hover:opacity-100 transition-opacity duration-300">Profile</span>
      </li>

      <li class="relative group">
        <a href="{% url 'notification' %}" class="hover:text-red-600 transition duration-300 relative">
          <i class='bx bxs-bell-ring text-xl'></i>
          {% if new_notifications_count > 0 %}
          <span class="absolute -top-2 -right-2 bg-red-600 text-white text-xs font-bold rounded-full h-4 w-4 flex items-center justify-center">
            {% if new_notifications_count >= 9 %}
              9+
            {% else %}
              {{ new_notifications_count }}
            {% endif %}
          </span>
      {% endif %}
        </a>
        <span class="absolute bottom-8 left-1/2 transform -translate-x-1/2 bg-black text-white text-xs rounded px-2 py-1 opacity-0 group-hover:opacity-100 transition-opacity duration-300">
            Notifications
        </span>
    </li> 


      <li class="relative group">
        <a href="{% url 'signout' %}" class="hover:text-red-600 transition duration-300">
          <i class='bx bxs-log-out text-xl'></i>
        </a>
        <span class="absolute bottom-8 left-1/2 transform -translate-x-1/2 bg-black text-white text-xs rounded px-2 py-1 opacity-0 group-hover:opacity-100 transition-opacity duration-300">Logout</span>
      </li>
      {% else %}
      <li class="relative group">
        <a href="{% url 'signin' %}" class="hover:text-red-600 transition duration-300">
          <i class='bx bxs-log-in text-xl'></i>
        </a>
        <span class="absolute bottom-8 left-1/2 transform -translate-x-1/2 bg-black text-white text-xs rounded px-2 py-1 opacity-0 group-hover:opacity-100 transition-opacity duration-300">Login</span>
      </li>
      {% endif %}
    </ul>
    

    <button id="menu-icon" class="text-gray-700 md:hidden">
      <i class='bx bx-menu text-3xl'></i>
      {% if new_notifications_count > 0 %}
          <span class="absolute top-7 right-2 bg-red-600 text-white text-xs font-bold rounded-full h-5 w-5 flex items-center justify-center">
            {% if new_notifications_count >= 9 %}
              9+
            {% else %}
              {{ new_notifications_count }}
            {% endif %}
          </span>
      {% endif %} 
    </button>
  </div>

  
  {% comment %} for mobile devices {% endcomment %}
<div id="mobile-menus" class="md:hidden hidden flex-col bg-gradient-to-r from-gray-100 to-gray-200 shadow-lg rounded-lg p-4 transition duration-300">
  <ul class="text-gray-800 space-y-2">
    <li>
      <a href="/" class="flex items-center hover:bg-red-200 hover:text-red-600 py-2 rounded transition duration-300">
        <i class='bx bx-home mr-2'></i> Home
      </a>
    </li>
    {% if user.is_authenticated %}
      <li>
        <a href="{% url 'profile' %}" class="flex items-center hover:bg-red-200 hover:text-red-600 py-2 rounded transition duration-300">
          <i class='bx bx-user mr-2'></i> Profile
        </a>
      </li>
      <li>

        <li>
        <a href="{% url 'notification' %}" class="flex items-center hover:bg-red-200 hover:text-red-600 py-2 rounded transition duration-300">
          <i class='bx bx-bell mr-2'></i>Notification
          {% if new_notifications_count > 0 %}
          <span style="position:absolute; top:12.2rem; right:22.5rem;" class="bg-red-600 text-white text-xs font-bold rounded-full h-4 w-4 flex items-center justify-center">
            {% if new_notifications_count >= 9 %}
              9+
            {% else %}
              {{ new_notifications_count }}
            {% endif %}
          </span>
      {% endif %}
        </a>
      </li>

      <li>
        <a href="{% url 'signout' %}" class="flex items-center hover:bg-red-200 hover:text-red-600 py-2 rounded transition duration-300">
          <i class='bx bx-log-out mr-2'></i> Logout
        </a>
      </li>
    {% else %}
      <li>
        <a href="{% url 'signin' %}" class="flex items-center hover:bg-red-200 hover:text-red-600 py-2 rounded transition duration-300">
          <i class='bx bx-log-in mr-2'></i> Login
        </a>
      </li>
    {% endif %}
  </ul>
</div>
</nav>


<script>
  const menuIcon = document.getElementById("menu-icon");
  const mobileMenus = document.getElementById("mobile-menus");

  menuIcon.addEventListener("click", () => {
    mobileMenus.classList.toggle("hidden");
  });

  const searchIcon = document.getElementById('searchIcon');
  const searchInput = document.getElementById('searchInput');
  searchIcon.addEventListener('click', function(){
    searchInput.style.display = "block";
    searchIcon.style.display = "none";
  })

  
</script>
